<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>SplayTree</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library SplayTree</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Lists.ListSet</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Lists.List</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Structures.Orders</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">FunInd</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Sorting.Sorted</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.omega.Omega</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ST</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">XSet</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ST</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ListTree</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">ST</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">MyTactics</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">SplayTree</span>(<span class="id" title="var">o</span> : <span class="id" title="var">OrderedType.OrderedType</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <span class="id" title="var">XSet.OrderedSet</span>(<span class="id" title="var">o</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab1"></a><h1 class="section">Structural definition of tree with</h1>

      ordered type elements.
  
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">tree</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">L</span> <br/>
&nbsp;&nbsp;| <span class="id" title="var">T</span> (<span class="id" title="var">t1</span> : <span class="id" title="var">tree</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">o.t</span>) (<span class="id" title="var">t2</span> : <span class="id" title="var">tree</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <span class="id" title="var">EqNotation</span>(<span class="id" title="var">o</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <span class="id" title="var">LtNotation</span>(<span class="id" title="var">o</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">ins_list</span> (<span class="id" title="var">x</span> : <span class="id" title="var">o.t</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">o.t</span>) : <span class="id" title="var">list</span> <span class="id" title="var">o.t</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| []   =&gt; [<span class="id" title="var">x</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">h</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">eq_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="keyword">then</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> (<span class="id" title="keyword">if</span> <span class="id" title="var">lt_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="keyword">then</span> <span class="id" title="var">x</span> :: <span class="id" title="var">l</span> <span class="id" title="keyword">else</span> <span class="id" title="var">a</span> :: <span class="id" title="var">ins_list</span> <span class="id" title="var">x</span> <span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">del_list</span> (<span class="id" title="var">x</span> : <span class="id" title="var">o.t</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">o.t</span>) : <span class="id" title="var">list</span> <span class="id" title="var">o.t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span> :: <span class="id" title="var">h</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">eq_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="keyword">then</span> <span class="id" title="var">h</span> <span class="id" title="keyword">else</span> <span class="id" title="var">a</span> :: (<span class="id" title="var">del_list</span> <span class="id" title="var">x</span> <span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab2"></a><h1 class="section">Simple notation for trees.</h1>

<ul class="doclist">
<li> &lt;| |&gt; are leaves and 

</li>
<li> &lt;|t1 , n , t2 |&gt; are nodes with value "n" and 

</li>
</ul>
      with left "t1" and right "t2" child nodes.
  
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot; &lt;| |&gt; " := <span class="id" title="var">L</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> &quot; &lt;| t1 , n , t2 |&gt;  " := (<span class="id" title="var">T</span> <span class="id" title="var">t1</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab3"></a><h1 class="section">Functional implementation of the splay tree algorithm and other useful</h1>

      functions that will be used in following proofs.
   
<div class="paragraph"> </div>

 A size function that counts the number of nodes in tree 't' 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">size</span> (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="var">nat</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; <span class="id" title="var">O</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">t1</span> , <span class="id" title="var">_</span>, <span class="id" title="var">t2</span> |&gt;  =&gt; <span class="id" title="var">size</span> <span class="id" title="var">t1</span> + <span class="id" title="var">size</span> <span class="id" title="var">t2</span> + 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
An in order function that transforms tree 't' into a list. 
      If the tree is ordered, then it will produce an ordered list
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">in_order</span> (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="var">list</span> <span class="id" title="var">o.t</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; [ ] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">t1</span> , <span class="id" title="var">a</span>, <span class="id" title="var">t2</span> |&gt;  =&gt; (<span class="id" title="var">in_order</span> <span class="id" title="var">t1</span>) ++ [<span class="id" title="var">a</span>] ++ (<span class="id" title="var">in_order</span> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A set tree function that collects the elements of tree 't' into 
      a set.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">set_tree</span> (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>)  : <span class="id" title="var">XSet.t</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; <span class="id" title="var">XSet.empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt;   =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.union</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XSet.singleton</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XSet.union</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">l</span>) (<span class="id" title="var">set_tree</span> <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The splay tree method, that given value 'a' and tree 't', 
      it produces a new tree with the value 'a' at its root,
      if 'a' was in tree 't'. Otherwise, 
      it produces a new tree with the closest 
      valued node to 'a' in its root.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">splay</span> (<span class="id" title="var">a</span> : <span class="id" title="var">o.t</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="var">tree</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; &lt;| |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">cl</span> , <span class="id" title="var">c</span>, <span class="id" title="var">cr</span> |&gt; =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">eq_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> <span class="id" title="keyword">then</span> &lt;| <span class="id" title="var">cl</span> , <span class="id" title="var">c</span>, <span class="id" title="var">cr</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">lt_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="keyword">match</span> <span class="id" title="var">cl</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; &lt;| <span class="id" title="var">cl</span>, <span class="id" title="var">c</span>, <span class="id" title="var">cr</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">bl</span>, <span class="id" title="var">b</span>, <span class="id" title="var">br</span> |&gt; =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">eq_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> &lt;| <span class="id" title="var">bl</span>, <span class="id" title="var">b</span>, &lt;| <span class="id" title="var">br</span>, <span class="id" title="var">c</span>, <span class="id" title="var">cr</span> |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">lt_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="keyword">match</span> <span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">bl</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; &lt;| <span class="id" title="var">bl</span>, <span class="id" title="var">b</span>, &lt;| <span class="id" title="var">br</span>, <span class="id" title="var">c</span>, <span class="id" title="var">cr</span> |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">al</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">ar</span> |&gt; =&gt; &lt;| <span class="id" title="var">al</span>, <span class="id" title="var">a'</span>, &lt;| <span class="id" title="var">ar</span>, <span class="id" title="var">b</span>, &lt;| <span class="id" title="var">br</span>, <span class="id" title="var">c</span>, <span class="id" title="var">cr</span> |&gt; |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">match</span> <span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">br</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt;  &lt;| <span class="id" title="var">bl</span>, <span class="id" title="var">b</span>, &lt;| <span class="id" title="var">br</span>, <span class="id" title="var">c</span>, <span class="id" title="var">cr</span> |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">al</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">ar</span> |&gt; =&gt; &lt;| &lt;| <span class="id" title="var">bl</span>, <span class="id" title="var">b</span>, <span class="id" title="var">al</span> |&gt; , <span class="id" title="var">a'</span>, &lt;| <span class="id" title="var">ar</span>, <span class="id" title="var">c</span>, <span class="id" title="var">cr</span> |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">match</span> <span class="id" title="var">cr</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; &lt;| <span class="id" title="var">cl</span>, <span class="id" title="var">c</span>, <span class="id" title="var">cr</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">bl</span>, <span class="id" title="var">b</span>, <span class="id" title="var">br</span> |&gt; =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">eq_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> &lt;| &lt;| <span class="id" title="var">cl</span>, <span class="id" title="var">c</span>, <span class="id" title="var">bl</span> |&gt;, <span class="id" title="var">b</span>, <span class="id" title="var">br</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">lt_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <span class="id" title="keyword">match</span> <span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">bl</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; &lt;| &lt;| <span class="id" title="var">cl</span>, <span class="id" title="var">c</span>, <span class="id" title="var">bl</span> |&gt;, <span class="id" title="var">b</span>, <span class="id" title="var">br</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">al</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">ar</span> |&gt; =&gt; &lt;| &lt;| <span class="id" title="var">cl</span>, <span class="id" title="var">c</span>, <span class="id" title="var">al</span> |&gt;, <span class="id" title="var">a'</span>, &lt;| <span class="id" title="var">ar</span>, <span class="id" title="var">b</span>, <span class="id" title="var">br</span> |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">match</span> <span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">br</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; &lt;| &lt;| <span class="id" title="var">cl</span>, <span class="id" title="var">c</span>, <span class="id" title="var">bl</span> |&gt;, <span class="id" title="var">b</span>, <span class="id" title="var">br</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">al</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">ar</span> |&gt; =&gt; &lt;| &lt;| &lt;| <span class="id" title="var">cl</span>, <span class="id" title="var">c</span>, <span class="id" title="var">bl</span> |&gt;, <span class="id" title="var">b</span>, <span class="id" title="var">al</span> |&gt; , <span class="id" title="var">a'</span>, <span class="id" title="var">ar</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Is root predicate that is true whenever 
      element 'a' is in the root of tree 't'.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_root</span> (<span class="id" title="var">a</span> : <span class="id" title="var">o.t</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; <span class="id" title="var">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">r</span> |&gt;  =&gt; <span class="id" title="var">a'</span> == <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Is in predicate that is true whenever element 'a' is 
      in the tree. It applies the splay method to the tree in order
      to put it in its root.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">isin</span> (<span class="id" title="var">a</span> : <span class="id" title="var">o.t</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_root</span> <span class="id" title="var">a</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>).<br/>

<br/>
</div>

<div class="doc">
Simple empty predicate that tells when tree 't' is empty.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">empty</span> (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="keyword">Prop</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span> = &lt;| |&gt;.<br/>

<br/>
</div>

<div class="doc">
The insert method, which creates a new tree
      with element 'a' at its root and the others as
      its descendants.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">insert</span> (<span class="id" title="var">a</span> : <span class="id" title="var">o.t</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="var">tree</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;|  &lt;| |&gt; =&gt; &lt;| &lt;| |&gt;, <span class="id" title="var">a</span>, &lt;| |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|  &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">r</span> |&gt;  =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">eq_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span> <span class="id" title="keyword">then</span> &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <span class="id" title="var">lt_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span> <span class="id" title="keyword">then</span> &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a</span>, &lt;| &lt;|  |&gt; , <span class="id" title="var">a'</span>, <span class="id" title="var">r</span> |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> &lt;| &lt;| <span class="id" title="var">l</span> , <span class="id" title="var">a'</span>, &lt;|  |&gt; |&gt; , <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The splay_max method splays the maximum element of tree 't'.
      We do not need to give any element, because we know which element 
      is the maximum, whenever the tree is ordered.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">splay_max</span> (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="var">tree</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; &lt;| |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">b</span>, &lt;| |&gt; |&gt; =&gt; &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">b</span>, &lt;| |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">b</span>, &lt;| <span class="id" title="var">rl</span>, <span class="id" title="var">c</span>, <span class="id" title="var">rr</span> |&gt; |&gt; =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">splay_max</span> <span class="id" title="var">rr</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; &lt;| &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">b</span>, <span class="id" title="var">rl</span> |&gt; , <span class="id" title="var">c</span>, &lt;| |&gt; |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">rrl</span>, <span class="id" title="var">x</span>, <span class="id" title="var">xa</span> |&gt; =&gt; &lt;| &lt;| &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">b</span>, <span class="id" title="var">rl</span> |&gt; , <span class="id" title="var">c</span>,  <span class="id" title="var">rrl</span> |&gt;, <span class="id" title="var">x</span> , <span class="id" title="var">xa</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The delete method, which produces a new tree 
      without element 'a' in it. If the tree doesn't
      have element 'a', it only applies the splay method
      without deleting anything.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">delete</span> (<span class="id" title="var">a</span> : <span class="id" title="var">o.t</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="var">tree</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;|  &lt;| |&gt; =&gt; &lt;| |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|  &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">r</span> |&gt;  =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">eq_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span> <span class="id" title="keyword">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">splay_max</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">l'</span>, <span class="id" title="var">m</span>, <span class="id" title="var">r'</span> |&gt;  =&gt; &lt;| <span class="id" title="var">l'</span>, <span class="id" title="var">m</span>, <span class="id" title="var">r</span> |&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">r</span> |&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The binary search tree (bst) predicate.
      It gives True whenever tree 't' is ordered, i.e., 
      for a given node of a tree, its value must be higher
      than all of the descendant nodes to its left child and must be lower
      than all of the descendant nodes to its right.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">bst</span> (<span class="id" title="var">t</span> : <span class="id" title="var">tree</span>) : <span class="id" title="keyword">Prop</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt; =&gt; <span class="id" title="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt; =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">set_l</span> := <span class="id" title="var">set_tree</span> <span class="id" title="var">l</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">set_r</span> := <span class="id" title="var">set_tree</span> <span class="id" title="var">r</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">bst</span> <span class="id" title="var">l</span>) /\ (<span class="id" title="var">bst</span> <span class="id" title="var">r</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XSet.For_all</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">n</span> &lt; <span class="id" title="var">a</span>) (<span class="id" title="var">set_l</span>) /\ <span class="id" title="var">XSet.For_all</span>  (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">a</span> &lt; <span class="id" title="var">n</span>) (<span class="id" title="var">set_r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The equal tree predicate, which is true whenever two 
      trees, 't1' and 't2' are the same semantically, i.e., 
      we have a1 == a2 for all nodes. NOTE that the sematical predicate (==) is not the 
      same as the syntatical predicate (=).
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">eq_tree</span> (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> : <span class="id" title="var">tree</span>) : <span class="id" title="keyword">Prop</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t1</span>,<span class="id" title="var">t2</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| |&gt;, &lt;| |&gt; =&gt; <span class="id" title="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| &lt;| <span class="id" title="var">l1</span>, <span class="id" title="var">a1</span>, <span class="id" title="var">r1</span> |&gt;, &lt;| <span class="id" title="var">l2</span>, <span class="id" title="var">a2</span>, <span class="id" title="var">r2</span> |&gt; =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">eq_l</span> := <span class="id" title="var">eq_tree</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">eq_r</span> := <span class="id" title="var">eq_tree</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_l</span> /\ <span class="id" title="var">eq_r</span> /\ (<span class="id" title="var">a1</span> == <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>,<span class="id" title="var">_</span> =&gt; <span class="id" title="var">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Functional Scheme</span> <span class="id" title="var">splay_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">splay</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Functional Scheme</span> <span class="id" title="var">insert_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">insert</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Functional Scheme</span> <span class="id" title="var">delete_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">delete</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Functional Scheme</span> <span class="id" title="var">splay_max_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">splay_max</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab4"></a><h1 class="section">Lemmas and theorems for the splay tree implementation</h1>

   
<div class="paragraph"> </div>

 A singleton is a binary search tree.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bst_el</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> &lt;| &lt;| |&gt; , <span class="id" title="var">e</span>, &lt;| |&gt; |&gt;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> (<span class="id" title="tactic">split</span> || <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span> || <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span> || <span class="id" title="tactic">intros</span> || <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If two elements "e" and "e'" are semantically equal, 
      and we trade "e" with "e'" in a binary search tree, 
      then the tree will remain ordered, i.e., it will still 
      be a binary search tree.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bst_eq_root</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> <span class="id" title="var">e'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">e</span> == <span class="id" title="var">e'</span> -&gt; <span class="id" title="var">bst</span> &lt;| <span class="id" title="var">l</span> , <span class="id" title="var">e</span> , <span class="id" title="var">r</span> |&gt; -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> &lt;| <span class="id" title="var">l</span> , <span class="id" title="var">e'</span> , <span class="id" title="var">r</span> |&gt;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">x</span> &lt; <span class="id" title="var">e</span> -&gt; <span class="id" title="var">x</span> &lt; <span class="id" title="var">e'</span>). <span class="id" title="var">order</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">e</span> &lt; <span class="id" title="var">x</span> -&gt; <span class="id" title="var">e'</span> &lt; <span class="id" title="var">x</span>). <span class="id" title="var">order</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Splaying value 'a' that it is in the root of 
      the tree produces the same tree.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_of_root</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">a</span> <span class="id" title="var">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">splay</span> <span class="id" title="var">a</span> &lt;| <span class="id" title="var">l</span> , <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt; = &lt;| <span class="id" title="var">l</span> , <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; [<span class="id" title="tactic">reflexivity</span>|] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">not</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span> ; <span class="id" title="var">exfalso</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">n</span> ; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If value 'a' is in the root of the tree, 
      then 'a' belongs to the set of elements of the tree.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_el_in_root</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.In</span> <span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt; ).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">simpl</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span> ; <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_equal_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">t</span>,  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> == <span class="id" title="var">a</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.In</span> <span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt; ) &lt;-&gt; <span class="id" title="var">XSet.In</span> <span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.In</span> <span class="id" title="var">b</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span> <span class="id" title="var">H1</span> ; <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_el_in_root</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_eq_in_spec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>) <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H''</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H''</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "a" is in tree &lt;| l , a' , r |&gt; is equivalent to proposition P, then 
      we have 
<ul class="doclist">
<li> if "a" is in "l" then P

</li>
<li> if "a" is in "r" then P

</li>
<li> if "a" is equal to "a'" then P

</li>
</ul>
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_tree_in_equiv_and</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.In</span> <span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">r</span> |&gt; ) &lt;-&gt; <span class="id" title="var">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XSet.In</span> <span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">l</span>) -&gt; <span class="id" title="var">P</span>) /\ (<span class="id" title="var">XSet.In</span> <span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">r</span>) -&gt; <span class="id" title="var">P</span>) /\ (<span class="id" title="var">a</span> == <span class="id" title="var">a'</span> -&gt; <span class="id" title="var">P</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intro</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> ; <span class="id" title="var">set_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">left</span> + <span class="id" title="tactic">right</span> + <span class="id" title="var">set_reduction</span>) ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Set of tree "t" is equal to the set of elements
      transformed into a list.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equal_set_list_set_tree</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.Equal</span> (<span class="id" title="var">set_list</span> (<span class="id" title="var">in_order</span> <span class="id" title="var">t</span>)) (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span> ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intro</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_in_app_or_spec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt1</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt2</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_in_app_or_spec</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
Splaying a tree that has at least a node cannot 
      be equal to a leaf.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_node_not_nil</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">t1</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">splay</span> <span class="id" title="var">a</span> &lt;| <span class="id" title="var">t1</span>, <span class="id" title="var">n</span>, <span class="id" title="var">t2</span> |&gt; &lt;&gt; &lt;| |&gt;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">t1</span> <span class="id" title="var">n</span> <span class="id" title="var">t2</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">not</span> ; <span class="id" title="tactic">simpl</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">intro</span> ; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">t1</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t1_1</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t1_2</span>) ;  <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t2_1</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t2_2</span>) ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Splaying a tree results in a leaf iff 
      the tree is a leaf itself.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">splay_leaf_iff</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> = &lt;| |&gt; &lt;-&gt; <span class="id" title="var">t</span> = &lt;| |&gt;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intro</span> <span class="id" title="var">H</span> ; [| <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">reflexivity</span> ] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> ; [<span class="id" title="tactic">reflexivity</span>|] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">splay_node_not_nil</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ; <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Using the splay_max on a tree results in a leaf iff
      the tree is a leaf itself.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">splay_max_leaf_iff</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span> = &lt;| |&gt; &lt;-&gt; (<span class="id" title="var">t</span> = &lt;| |&gt;).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intro</span> <span class="id" title="var">H</span> ; [| <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">reflexivity</span>] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> ; [<span class="id" title="tactic">reflexivity</span>|] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> ; [<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>|] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t2_2</span>) ; [<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>|] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
If "t1" and "t2" are semantically equal, 
      and "x" is in "t1" then "x" is also in "t2".
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_tree_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_tree</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t1</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t1</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">XSet.singleton_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">right</span> ; <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt1_1</span> ; <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt1_2</span> ; <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
If "t1" and "t2" are semantically equal, 
      they have the same set of elements.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_tree_eq_set</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_tree</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.Equal</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">set_tree</span> <span class="id" title="var">t2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t1</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt1_1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt1_2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span> ; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">left</span> + <span class="id" title="tactic">right</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">left</span> + <span class="id" title="tactic">right</span>) ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span> ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The semantical predicate eq_tree is reflexive.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_tree_refl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_tree</span> <span class="id" title="var">t</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If two trees are syntatically the same, then they are 
      also semantically the same, because a = b -&gt; a == b.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">tree_syntatic_semantic</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t1</span> = <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">eq_tree</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The semantical predicate eq_tree is symmetric.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_tree_symm</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_tree</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">eq_tree</span> <span class="id" title="var">t2</span> <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">eq_tree</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The semantical predicate eq_tree is transitive.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_tree_trans</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_tree</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">eq_tree</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> -&gt; <span class="id" title="var">eq_tree</span> <span class="id" title="var">t1</span> <span class="id" title="var">t3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">t3</span> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">t3</span> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">unfold</span> <span class="id" title="var">eq_tree</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
The size of a tree is the same as the 
      size of the tree after being splayed.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">size_splay</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">size</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) = <span class="id" title="var">size</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_ind</span> ; <span class="id" title="tactic">simpl</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span> ; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHt0</span>) ; <span class="id" title="tactic">simpl</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span> ; <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t1" and "t2" are semantically the same, then 
      their size is also the same.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">size_eq_tree</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_tree</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> -&gt; <span class="id" title="var">size</span> <span class="id" title="var">t1</span> = <span class="id" title="var">size</span> <span class="id" title="var">t2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If splaying a tree "t" results in "&lt;| l, u, r |&gt;" then 
      the size of "t" (size t) is the same as the sum of the size of the splayed
      trees children "l" and "r" plus 1 ( size l + size r + 1 ).
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">size_if_splay</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> <span class="id" title="var">u</span> <span class="id" title="var">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_tree</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">u</span>, <span class="id" title="var">r</span> |&gt; -&gt; <span class="id" title="var">size</span> <span class="id" title="var">t</span> = <span class="id" title="var">size</span> <span class="id" title="var">l</span> + <span class="id" title="var">size</span> <span class="id" title="var">r</span> + 1.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_ind</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">intros</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">r2</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l1</span> ; <span class="id" title="var">logical_reduction</span> ;  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">size_eq_tree</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">size_eq_tree</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">size_eq_tree</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">size_eq_tree</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span> ; <span class="id" title="tactic">specialize</span> (<span class="id" title="var">eq_tree_refl</span> (&lt;| <span class="id" title="var">al</span>, <span class="id" title="var">a'</span>, <span class="id" title="var">ar</span> |&gt; )) <span class="id" title="keyword">as</span> <span class="id" title="var">refl</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">refl</span>) ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is not a leaf, then there exists a node "&lt;| l, x, r |&gt;"
      that corresponds to "t" after being splayed.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_not_leaf</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">t</span>:<span class="id" title="var">tree</span>) <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t</span> &lt;&gt; &lt;| |&gt; -&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>, <span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> = &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">x</span>, <span class="id" title="var">r</span> |&gt;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">simpl</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">t1</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">t2</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t1_1</span>) ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t1_2</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t2_1</span>) ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t2_2</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The set of elements of "t" are the same as the elements of the 
      tree afeter being splayed 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_splay</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.Equal</span> (<span class="id" title="var">set_tree</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>)) (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_ind</span> ; <span class="id" title="tactic">simpl</span> ; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intro</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> ((<span class="id" title="var">set_reduction</span> || <span class="id" title="var">logical_reduction</span> || <span class="id" title="tactic">assumption</span>)) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> * ; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">left</span> + <span class="id" title="tactic">right</span> + <span class="id" title="var">set_reduction</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tryif</span> <span class="id" title="tactic">reflexivity</span> <span class="id" title="keyword">then</span> <span class="id" title="tactic">idtac</span> <span class="id" title="keyword">else</span> <span class="id" title="tactic">assumption</span> ) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">left</span> + <span class="id" title="tactic">right</span> + <span class="id" title="var">set_reduction</span> +  <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tryif</span> <span class="id" title="tactic">reflexivity</span> <span class="id" title="keyword">then</span> <span class="id" title="tactic">idtac</span> <span class="id" title="keyword">else</span> <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab5"></a><h2 class="section">Tactic tree_reduction that simplifies some of the hypothesis</h2>

        of the next theorems/lemmas 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">tree_reduction</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">_</span> |- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_tree</span> ?<span class="id" title="var">t</span> ?<span class="id" title="var">t</span> =&gt; <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h1</span> : ?<span class="id" title="var">e</span> == ?<span class="id" title="var">e'</span>, <span class="id" title="var">h2</span> : <span class="id" title="var">bst</span> &lt;| ?<span class="id" title="var">l</span> , ?<span class="id" title="var">e</span> , ?<span class="id" title="var">r</span> |&gt; |- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> &lt;| ?<span class="id" title="var">l</span> , ?<span class="id" title="var">e'</span> , ?<span class="id" title="var">r</span> |&gt; =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">bst_eq_root</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> <span class="id" title="var">e'</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> :<span class="id" title="var">_</span> |- <span class="id" title="var">bst</span> &lt;| &lt;| |&gt;, ?<span class="id" title="var">a</span>, &lt;| |&gt; |&gt; =&gt; <span class="id" title="tactic">apply</span> <span class="id" title="var">bst_el</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">splay</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">bl</span> = &lt;| |&gt; |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">splay_leaf_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span> ; <span class="id" title="tactic">subst</span> ; <span class="id" title="var">tree_reduction</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> :  &lt;| ?<span class="id" title="var">a</span>, ?<span class="id" title="var">b</span>, ?<span class="id" title="var">c</span>|&gt; = &lt;| ?<span class="id" title="var">d</span>, ?<span class="id" title="var">e</span>, ?<span class="id" title="var">f</span> |&gt; |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">h</span> ; <span class="id" title="tactic">subst</span>                                                <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h1</span> : <span class="id" title="var">splay</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">bl</span> = &lt;| ?<span class="id" title="var">al</span>, ?<span class="id" title="var">a'</span>, ?<span class="id" title="var">ar</span> |&gt;, <span class="id" title="var">h2</span> : <span class="id" title="var">bst</span> (<span class="id" title="var">splay</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">bl</span>) |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">h1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h2</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h2</span> ; <span class="id" title="var">tree_reduction</span>                                <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">splay</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">bl</span> = &lt;| ?<span class="id" title="var">al</span>, ?<span class="id" title="var">a'</span>, ?<span class="id" title="var">ar</span> |&gt; |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">h</span> <span class="id" title="tactic">in</span> * ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">bl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">set_splay_reduct</span>) ; <span class="id" title="var">tree_reduction</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">bst</span> &lt;| ?<span class="id" title="var">al</span>, ?<span class="id" title="var">a'</span>, ?<span class="id" title="var">ar</span> |&gt; |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span> ; <span class="id" title="var">tree_reduction</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">XSet.In</span> ?<span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> &lt;| ?<span class="id" title="var">al</span>, ?<span class="id" title="var">a'</span>, ?<span class="id" title="var">ar</span> |&gt;) |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span> ; <span class="id" title="var">tree_reduction</span>                   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">XSet.In</span> ?<span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> &lt;| |&gt;) |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">splay_max</span> ?<span class="id" title="var">t</span> = &lt;| |&gt; |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">splay_max_leaf_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span> ; <span class="id" title="var">tree_reduction</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h</span> : <span class="id" title="var">splay_max</span> ?<span class="id" title="var">t</span> = &lt;| |&gt; |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">splay_max_leaf_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h</span> ; <span class="id" title="var">tree_reduction</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">h1</span> : <span class="id" title="var">eq_tree</span> ?<span class="id" title="var">t1</span> ?<span class="id" title="var">t2</span>, <span class="id" title="var">h2</span> : <span class="id" title="var">XSet.In</span> ?<span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> ?<span class="id" title="var">t1</span>) |-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.In</span> ?<span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> ?<span class="id" title="var">t2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_in</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">x</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree and after splaying it with value "a" results in 
      &lt;| l, e, r |&gt;, then all values of elements of tree "l" 
      are lower than "a" 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_bstL</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">eq_tree</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">e</span>, <span class="id" title="var">r</span> |&gt; -&gt; <span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">l</span>) -&gt; <span class="id" title="var">x</span> &lt; <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_ind</span> ; <span class="id" title="tactic">simpl</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">splay_leaf_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e5</span>) ; <span class="id" title="tactic">intros</span> ; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H0'</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">eq_tree_in</span> <span class="id" title="var">l</span> <span class="id" title="var">cl</span> <span class="id" title="var">x</span> <span class="id" title="var">H0'</span> <span class="id" title="var">H1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H0'</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">eq_tree_in</span> <span class="id" title="var">l</span> <span class="id" title="var">bl</span> <span class="id" title="var">x</span> <span class="id" title="var">H0'</span> <span class="id" title="var">H1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H8</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt0</span> <span class="id" title="var">al</span> <span class="id" title="var">a'</span> <span class="id" title="var">ar</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> ; [<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|]. <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">al</span> <span class="id" title="var">l</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">bl</span> <span class="id" title="var">l</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">bl</span> <span class="id" title="var">l1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H8</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt0</span> <span class="id" title="var">al</span> <span class="id" title="var">a'</span> <span class="id" title="var">ar</span> <span class="id" title="var">x</span> <span class="id" title="var">H7</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> ; [<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">al</span> <span class="id" title="var">l2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H10</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H0'</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">eq_tree_in</span> <span class="id" title="var">l</span> <span class="id" title="var">cl</span> <span class="id" title="var">x</span> <span class="id" title="var">H0'</span> <span class="id" title="var">H1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">cl</span> <span class="id" title="var">l1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">bl</span> <span class="id" title="var">l2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H10</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H8</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">cl</span> <span class="id" title="var">l1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">cl</span> <span class="id" title="var">l1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt0</span> <span class="id" title="var">al</span> <span class="id" title="var">a'</span> <span class="id" title="var">ar</span> <span class="id" title="var">x</span> <span class="id" title="var">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> ; [<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H10'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_in</span> <span class="id" title="var">l2</span> <span class="id" title="var">al</span> <span class="id" title="var">x</span> <span class="id" title="var">H10'</span> <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">cl</span> <span class="id" title="var">l1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">bl</span> <span class="id" title="var">l2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H9</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l1</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H0'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">cl</span> <span class="id" title="var">l1_1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H12</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H12'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">bl</span> <span class="id" title="var">l1_2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H12</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H12</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H8</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H2'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">al</span> <span class="id" title="var">l2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H10</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt0</span> <span class="id" title="var">al</span> <span class="id" title="var">a'</span> <span class="id" title="var">ar</span> <span class="id" title="var">x</span> <span class="id" title="var">H7</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> ; [<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|]. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_bstL'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) = &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">e</span>, <span class="id" title="var">r</span> |&gt; -&gt; <span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">l</span>) -&gt; <span class="id" title="var">x</span> &lt; <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tree_syntatic_semantic</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">splay_bstL</span> <span class="id" title="var">t0</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span> <span class="id" title="var">H0</span> <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree and after splaying it with value "a" results in 
      &lt;| l, e, r |&gt;, then all values of elements of tree "r" 
      are higher than "a" 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_bstR</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">eq_tree</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">e</span>, <span class="id" title="var">r</span> |&gt; -&gt; <span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">r</span>) -&gt; <span class="id" title="var">a</span> &lt; <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_ind</span> ; <span class="id" title="tactic">simpl</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">splay_leaf_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e5</span>) ; <span class="id" title="tactic">intros</span> ; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H2'</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">eq_tree_in</span> <span class="id" title="var">r</span> <span class="id" title="var">cr</span> <span class="id" title="var">x</span> <span class="id" title="var">H2'</span> <span class="id" title="var">H1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">cr</span> <span class="id" title="var">r</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">br</span> <span class="id" title="var">r1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H9</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">cr</span> <span class="id" title="var">r2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H10</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">br</span> <span class="id" title="var">r1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H7</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H7</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">cr</span> <span class="id" title="var">r2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H9</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="var">ar</span> <span class="id" title="var">r1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt0</span> <span class="id" title="var">al</span> <span class="id" title="var">a'</span> <span class="id" title="var">ar</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> ; [<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|]. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">r2</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H10</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H9</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H14</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H14</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">r1</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H7</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H7</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHt0</span> <span class="id" title="var">al</span> <span class="id" title="var">a'</span> <span class="id" title="var">ar</span> <span class="id" title="var">x</span> <span class="id" title="var">H7</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> ; [<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|]. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H10</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H9</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H7</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H7</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>, <span class="id" title="var">l</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt0</span> <span class="id" title="var">al</span> <span class="id" title="var">a'</span> <span class="id" title="var">ar</span> <span class="id" title="var">x</span> <span class="id" title="var">H4</span>) ; [<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H10</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H9</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt0</span> <span class="id" title="var">al</span> <span class="id" title="var">a'</span> <span class="id" title="var">ar</span> <span class="id" title="var">x</span> <span class="id" title="var">H7</span>) ; [<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_bstR'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) = &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">e</span>, <span class="id" title="var">r</span> |&gt; -&gt; <span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">r</span>) -&gt; <span class="id" title="var">a</span> &lt; <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tree_syntatic_semantic</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">splay_bstR</span> <span class="id" title="var">t0</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span> <span class="id" title="var">H0</span> <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree, then splaying it also results
      in a binary search tree. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">bst_splay</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_ind</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">auto</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="var">tree_reduction</span> ; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> (<span class="id" title="var">order</span> || <span class="id" title="var">logical_reduction</span> || <span class="id" title="var">set_reduction</span> || <span class="id" title="var">logical_reduction</span> || <span class="id" title="var">set_create</span> ).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree and if "t'" is the result of splaying "t", 
      then "a" is in "t" iff exists "l" and "r" where "t'" is equal to "&lt; | l , a , r | &gt; "
      (where "a" is in the root of the splayed tree). 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">splay_to_root</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">t'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">eq_tree</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="var">t'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">XSet.In</span> <span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>) &lt;-&gt;  (<span class="id" title="tactic">exists</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>, <span class="id" title="var">eq_tree</span> <span class="id" title="var">t'</span> &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt;)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> ; <span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">insert</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">insert_ind</span> ; <span class="id" title="var">tree_reduction</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t'</span> ; [<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>|<span class="id" title="var">contradiction</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t'</span> ; [<span class="id" title="var">contradiction</span>|]. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exists</span> <span class="id" title="var">l</span>, <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_symm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ; <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">set_splay_reduct</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">set_splay_reduct</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstL</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">a</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstR</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">a</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">t'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_splay_reduct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">t'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span> ; <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">set_splay_reduct</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstL</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">a</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstR</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">a</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">logical_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree, "a" is in the root of "(splay a t)" iff 
   "a" is in tree "t" 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_root_splay</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">is_root</span> <span class="id" title="var">a</span> (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) &lt;-&gt; <span class="id" title="var">XSet.In</span> <span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> ; <span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">insert</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">insert_ind</span> ; <span class="id" title="var">tree_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">order</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">set_in_empty_false_spec</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">set_splay_reduct</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span> ; <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_splay_reduct</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstL</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">a</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ( <span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span> ). <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstR</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">a</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">assert</span> ( <span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">set_splay_reduct</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstL</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">a</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">assert</span> ( <span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstR</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">a</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">assert</span> ( <span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The set of elements of tree "t" after inserting element "a" is the 
      same as the union of the singleton element "a" with the set of elements of "t". 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_insert</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.Equal</span> (<span class="id" title="var">set_tree</span> (<span class="id" title="var">insert</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>)) (<span class="id" title="var">XSet.union</span> (<span class="id" title="var">XSet.singleton</span> <span class="id" title="var">a</span>) (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> ; <span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">insert</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">insert_ind</span> ; <span class="id" title="var">tree_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">set_union_empty_spec</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree, inserting "a" in tree "t" results in 
      a binary search tree as well.
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bst_insert</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">insert</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> ; <span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">insert</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">insert_ind</span> ; <span class="id" title="tactic">intro</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">tree_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">e0</span>. <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">_x</span>. <span class="id" title="var">tree_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span> := <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstL</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span> ; <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H''</span> <span class="id" title="var">x</span> <span class="id" title="var">H'</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">H''</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">set_create</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span> := <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">set_create</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">x</span> &lt; <span class="id" title="var">a'</span> -&gt; <span class="id" title="var">x</span> &lt; <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstR</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H''</span> <span class="id" title="var">x</span> <span class="id" title="var">H'</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">apply</span> <span class="id" title="var">H''</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>|<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The size of tree "t" is the same as the size of tree "t" after 
      applying splay max in it.
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">size_splay_max</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">size</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>) = <span class="id" title="var">size</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_max_ind</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">splay_max_leaf_iff</span> <span class="id" title="var">rr</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If splay maxing "t" results in "&lt;| l, u, r |&gt;" then the
      size of "t" is equal to the sum of the size of "l" and "r" plus 1 
      (size of u).
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">size_if_splay_max</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> <span class="id" title="var">u</span> <span class="id" title="var">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span> = &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">u</span>, <span class="id" title="var">r</span> |&gt; -&gt; <span class="id" title="var">size</span> <span class="id" title="var">t</span> = <span class="id" title="var">size</span> <span class="id" title="var">l</span> + <span class="id" title="var">size</span> <span class="id" title="var">r</span> + 1.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> <span class="id" title="var">u</span> <span class="id" title="var">r</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">size_splay_max</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The set of elements of "t" is equal to the set of elements of "t"
      after splay maxing it.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_splay_max</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XSet.Equal</span> (<span class="id" title="var">set_tree</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>)) (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_max_ind</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span> ; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intro</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">try</span> (<span class="id" title="var">set_reduction</span> || <span class="id" title="var">logical_reduction</span> || <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span> ; <span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-  <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span> ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">tree_reduction</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">tree_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span> ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> *. <span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span> ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span> ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree, then splay maxing it results in 
      a binary search tree as well. (invariant of bst).
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bst_splay_max</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_max_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H8</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">IHt0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span> ; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">set_create</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H11</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ssm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssm</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">x0</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">rr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ssm</span>. <span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H12</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ssm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ssm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ssm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssm</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">rr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ssm</span>. <span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span> ; <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H10</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H12</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ssm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssm</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">rr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ssm</span>. <span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span> ; <span class="id" title="var">set_reduction</span>. <span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">left</span> ; <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
After splay maxing a tree "t", its right child is a leaf.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_max_leaf</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> <span class="id" title="var">a</span> <span class="id" title="var">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span> = &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">a</span>, <span class="id" title="var">r</span> |&gt; -&gt; <span class="id" title="var">r</span> = &lt;| |&gt;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_max_ind</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHt0</span> <span class="id" title="var">rrl</span> <span class="id" title="var">a</span> <span class="id" title="var">r</span>) ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree, and if all elements in "t" are 
      lower than "a" or equal to "a", then splay maxing t is the same
      as applying splay with element "a".
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_max_eq_splay</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>) -&gt; <span class="id" title="var">x</span> &lt; <span class="id" title="var">a</span> \/ <span class="id" title="var">x</span> == <span class="id" title="var">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span> = <span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_max_ind</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H0</span> <span class="id" title="var">b</span>). <span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">b</span> (<span class="id" title="var">set_tree</span> &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">b</span>, &lt;| |&gt; |&gt;)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H0</span> <span class="id" title="var">b</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">b</span> (<span class="id" title="var">set_tree</span> &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">b</span>, &lt;|<span class="id" title="var">rl</span>,<span class="id" title="var">c</span>,<span class="id" title="var">rr</span> |&gt; |&gt;)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H0</span> <span class="id" title="var">c</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H''</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">c</span> (<span class="id" title="var">set_tree</span> &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">b</span>, &lt;|<span class="id" title="var">rl</span>,<span class="id" title="var">c</span>,<span class="id" title="var">rr</span> |&gt; |&gt;)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">splay_max_leaf_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H0</span> <span class="id" title="var">c</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">c</span> &lt; <span class="id" title="var">a</span> \/ <span class="id" title="var">c</span> == <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tree_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">splay_max_leaf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">e2</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">new</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span> ; <span class="id" title="tactic">intros</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">right</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">right</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">right</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">right</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">rr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H7</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H13</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H7'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H12</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H13</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H12'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span>  (<span class="id" title="var">x</span> &lt; <span class="id" title="var">a</span> \/ <span class="id" title="var">x</span> == <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">rr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H7</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H13</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H7'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H12</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H13</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H12'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span>  (<span class="id" title="var">x</span> &lt; <span class="id" title="var">a</span> \/ <span class="id" title="var">x</span> == <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_max_eq_splay'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>) -&gt; <span class="id" title="var">x</span> &lt; <span class="id" title="var">a</span> \/ <span class="id" title="var">x</span> == <span class="id" title="var">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_tree</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>) (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_max_eq_splay</span> <span class="id" title="var">t0</span> <span class="id" title="var">a</span> <span class="id" title="var">H</span> <span class="id" title="var">H0</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tree_syntatic_semantic</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree, and splay maxing t results in 
      "&lt; | l , x , &lt;| |&gt; |&gt;", then all elements of "t" are either lower
      than "x" or equal to "x".
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_max_root</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span> = &lt;| <span class="id" title="var">l</span>, <span class="id" title="var">x</span>, &lt;| |&gt; |&gt; -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">XSet.In</span> <span class="id" title="var">y</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>) -&gt; <span class="id" title="var">y</span> &lt; <span class="id" title="var">x</span> \/ <span class="id" title="var">y</span> == <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>  <span class="id" title="var">bst_splay_max</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H'</span> <span class="id" title="var">y</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Given an element of the ordered type set, if "t" is 
      a binary search tree, then there exists a value "a"
      for which splay maxing "t" is equal to splaying "t" with 
      value "a".
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">splay_max_eq_splay_ex</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> (<span class="id" title="var">e</span> : <span class="id" title="var">o.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; (<span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, <span class="id" title="var">eq_tree</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>) (<span class="id" title="var">splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">splay_max</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">splay_max_ind</span> ; <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">splay_of_root</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="var">c</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">E1</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> ; <span class="id" title="var">order</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="var">order</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="var">order</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ; <span class="id" title="var">order</span> ; <span class="id" title="tactic">destruct</span> (<span class="id" title="var">splay</span> <span class="id" title="var">c</span> <span class="id" title="var">l2</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">splay_max_leaf_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span> ; <span class="id" title="tactic">subst</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">tree_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> ( <span class="id" title="var">splay_max_leaf</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">e2</span> := <span class="id" title="var">e1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e2</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">E1</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> ( <span class="id" title="var">set_splay</span> <span class="id" title="var">x0</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ssxrr</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_eq_set</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H7</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssxrr</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssxrr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssxrr</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">ssxrr</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">XSet.union</span> (<span class="id" title="var">XSet.singleton</span> <span class="id" title="var">x</span>) (<span class="id" title="var">XSet.union</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">rrl</span>) <span class="id" title="var">XSet.empty</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">ssxrr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H8</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span> ; <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ;<span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ssxrr</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssxrr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssxrr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">XSet.union</span> (<span class="id" title="var">XSet.singleton</span> <span class="id" title="var">x</span>) (<span class="id" title="var">XSet.union</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">rrl</span>) <span class="id" title="var">XSet.empty</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">ssxrr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H11</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H8</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ssxrr</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssxrr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssxrr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">rr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ssxrr</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H8</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H12</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H8'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H12</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H5'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">rr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ssxrr</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssxrr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ssxrr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">XSet.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">rr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ssxrr</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H8</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H12</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H8'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H12</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H5'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">eq_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lt_dec</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_max_root</span> <span class="id" title="var">rr</span> <span class="id" title="var">rrl</span> <span class="id" title="var">x</span> <span class="id" title="var">H3</span> <span class="id" title="var">e1</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H''''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_max_eq_splay</span> <span class="id" title="var">rr</span> <span class="id" title="var">x</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H'''</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H''''</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H''''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">tree_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> ; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary sesarch tree, then using the delete method
      with value "a" on tree "t" results in the same set of elements 
      as removing "a" from the set of elements of "t".
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">set_delete</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">XSet.Equal</span> (<span class="id" title="var">set_tree</span> (<span class="id" title="var">delete</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>)) (<span class="id" title="var">XSet.remove</span> <span class="id" title="var">a</span> (<span class="id" title="var">set_tree</span> <span class="id" title="var">t</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">delete</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">delete_ind</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">tree_reduction</span>. <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">set_equal_comm_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">set_remove_empty_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">tree_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) ; <span class="id" title="tactic">intro</span> <span class="id" title="var">H'</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">XSet.remove_spec</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstR</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> (&lt;||&gt;) <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">a</span> &lt; <span class="id" title="var">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H''</span>; <span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eq_tree_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstR</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> (&lt;||&gt;) <span class="id" title="var">a'</span> <span class="id" title="var">r</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">apply</span> <span class="id" title="var">XSet.remove_spec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span>. <span class="id" title="tactic">intros</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">XSet.remove_spec</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H''</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span> ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H''</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span> ; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">bst_splay_max</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H''''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">bst_splay_a_t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">bst_splay_a_t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">a0</span> &lt; <span class="id" title="var">a'</span> \/ <span class="id" title="var">a0</span> &gt; <span class="id" title="var">a'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">e2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">e2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">splay_max_leaf</span> <span class="id" title="var">l</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ssat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ssat</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">e2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="tactic">right</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.Equal</span> ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">e1</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">XSet.remove_spec</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">tree_syntatic_semantic</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_reduction</span>. <span class="id" title="var">logical_reduction</span> ; <span class="id" title="var">set_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span> ; <span class="id" title="tactic">try</span> <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstL</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span> <span class="id" title="var">a0</span> <span class="id" title="var">H</span> <span class="id" title="var">e</span> <span class="id" title="var">H0</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">splay_bstR</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">a'</span> <span class="id" title="var">r</span> <span class="id" title="var">a0</span> <span class="id" title="var">H</span> <span class="id" title="var">e</span> <span class="id" title="var">H0</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">XSet.remove_spec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">e1</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If "t" is a binary search tree, then deleting an element from the tree
      also results in a binary search tree.
   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bst_delete</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">delete</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">functional</span> <span class="id" title="tactic">induction</span> (<span class="id" title="var">delete</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span>) <span class="id" title="keyword">using</span> <span class="id" title="var">delete_ind</span> ; <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">n'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">n'</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n'</span> ; <span class="id" title="var">logical_reduction</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">bst_splay_max</span> <span class="id" title="var">l</span> <span class="id" title="var">H</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span> ; <span class="id" title="var">logical_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">XSet.For_all</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">m</span> &lt; <span class="id" title="var">a'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">set_splay_max</span> <span class="id" title="var">l</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H8</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">set_reduction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="var">set_reduction</span>. <span class="id" title="var">order</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<span class="id" title="var">bst_splay</span> <span class="id" title="var">a</span> <span class="id" title="var">t</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">SplayTree</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>